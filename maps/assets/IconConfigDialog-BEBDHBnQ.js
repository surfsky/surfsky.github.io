import{d as n,T as e}from"./map-W8RwU3mL.js";const t=class t{constructor(){this.modal=null,this.config={},this.createModal(),this.bindEvents(),this.injectStyles(),this.initIconSettings()}static getInstance(){return this.instance||(this.instance=new t),this.instance}static show(n){const e=this.getInstance();e.onConfigChanged=n,e.show()}static hide(){this.getInstance().hide()}getSettings(){return this.config}setSettings(n){var e;this.config=n,(null==(e=this.modal)?void 0:e.classList.contains("show"))&&this.updateContent()}static onSettingsChange(n){this.getInstance().onConfigChanged=n}init(){}createModal(){this.modal=document.createElement("div"),this.modal.className="settings-modal",this.modal.innerHTML='\n            <div class="settings-modal-content">\n                <div class="settings-modal-header">\n                    <h3>图标设置</h3>\n                    <button class="settings-modal-close" data-action="close">&times;</button>\n                </div>\n                <div class="settings-modal-body">\n                    \x3c!-- 类别设置将在这里动态生成 --\x3e\n                </div>\n                <div class="settings-modal-footer">\n                    <button class="settings-btn-cancel" data-action="cancel">取消</button>\n                    <button class="settings-btn-save" data-action="save">保存</button>\n                </div>\n            </div>\n        ',document.body.appendChild(this.modal)}bindEvents(){this.modal&&(this.modal.addEventListener("click",n=>{n.target===this.modal&&this.hide()}),this.modal.addEventListener("click",n=>{switch(n.target.getAttribute("data-action")){case"close":case"cancel":this.hide();break;case"save":this.saveSettings()}}),document.addEventListener("keydown",n=>{var e;"Escape"===n.key&&(null==(e=this.modal)?void 0:e.classList.contains("show"))&&this.hide()}))}injectStyles(){const n="setting-panel-styles";if(document.getElementById(n))return;const e=document.createElement("style");e.id=n,e.textContent="\n            .settings-btn {\n                width: 28px;\n                height: 28px;\n                border-radius: 4px;\n                border: 1px solid #ddd;\n                background: #f8f9fa;\n                color: #495057;\n                cursor: pointer;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                font-size: 14px;\n                transition: all 0.2s ease;\n                flex-shrink: 0;\n                background-image: url('/assets/icon/settings.svg');\n                background-repeat: no-repeat;\n                background-position: center;\n                background-size: 16px 16px;\n            }\n\n            .settings-btn:hover {\n                background-color: #e9ecef;\n                border-color: #adb5bd;\n                transform: scale(1.05);\n            }\n\n            .settings-btn:active {\n                transform: scale(0.95);\n            }\n\n            .settings-modal {\n                position: fixed;\n                top: 0;\n                left: 0;\n                width: 100%;\n                height: 100%;\n                background: rgba(0, 0, 0, 0.5);\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                z-index: 20000;\n                opacity: 0;\n                visibility: hidden;\n                transition: opacity 0.3s ease, visibility 0.3s ease;\n                box-sizing: border-box;\n                padding: 20px;\n            }\n\n            .settings-modal.show {\n                opacity: 1;\n                visibility: visible;\n            }\n\n            .settings-modal-content {\n                background: white;\n                border-radius: 8px;\n                width: 90%;\n                max-width: 500px;\n                max-height: 80vh;\n                overflow-y: auto;\n                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);\n            }\n\n            .settings-modal-header {\n                padding: 20px;\n                border-bottom: 1px solid #e9ecef;\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n            }\n\n            .settings-modal-header h3 {\n                margin: 0;\n                color: #333;\n                font-size: 18px;\n            }\n\n            .settings-modal-close {\n                background: none;\n                border: none;\n                font-size: 24px;\n                cursor: pointer;\n                color: #666;\n                padding: 0;\n                width: 30px;\n                height: 30px;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                border-radius: 50%;\n                transition: all 0.2s ease;\n            }\n\n            .settings-modal-close:hover {\n                background: #f8f9fa;\n                color: #333;\n            }\n\n            .settings-modal-body {\n                padding: 20px;\n            }\n\n            .category-setting {\n                padding: 15px 0;\n                border-bottom: 1px solid #f0f0f0;\n            }\n\n            .category-setting-header {\n                display: flex;\n                align-items: center;\n                justify-content: space-between;\n                margin-bottom: 10px;\n            }\n\n            .category-controls {\n                display: flex;\n                align-items: center;\n                gap: 15px;\n            }\n\n            .show-text-label,\n            .text-size-label {\n                display: flex;\n                align-items: center;\n                gap: 5px;\n                font-size: 14px;\n            }\n\n            .text-size-input {\n                width: 50px;\n                padding: 4px;\n                border: 1px solid #ccc;\n                border-radius: 4px;\n            }\n\n            .category-setting:last-child {\n                border-bottom: none;\n            }\n\n            .category-name {\n                font-weight: 500;\n                color: #333;\n                flex: 1;\n            }\n\n            .icon-selector {\n                display: flex;\n                gap: 8px;\n                align-items: center;\n            }\n\n            .icon-option {\n                width: 32px;\n                height: 32px;\n                border: 2px solid #ddd;\n                border-radius: 4px;\n                cursor: pointer;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                transition: all 0.2s ease;\n                background-size: 20px 20px;\n                background-repeat: no-repeat;\n                background-position: center;\n            }\n\n            .icon-option:hover {\n                border-color: #007bff;\n                transform: scale(1.1);\n            }\n\n            .icon-option.selected {\n                border-color: #007bff;\n                background-color: #e2f0ff;\n            }\n\n            .settings-modal-footer {\n                padding: 20px;\n                border-top: 1px solid #e9ecef;\n                display: flex;\n                justify-content: flex-end;\n                gap: 10px;\n            }\n\n            .settings-btn-cancel {\n                padding: 8px 16px;\n                border: 1px solid #ddd;\n                background: white;\n                color: #333;\n                border-radius: 4px;\n                cursor: pointer;\n                transition: all 0.2s ease;\n            }\n\n            .settings-btn-cancel:hover {\n                background: #f8f9fa;\n            }\n\n            .settings-btn-save {\n                padding: 8px 16px;\n                border: none;\n                background: #007bff;\n                color: white;\n                border-radius: 4px;\n                cursor: pointer;\n                transition: all 0.2s ease;\n            }\n\n            .settings-btn-save:hover {\n                background: #0056b3;\n            }\n        ",document.head.appendChild(e)}show(){this.modal&&(this.updateContent(),this.modal.classList.add("show"))}hide(){this.modal&&this.modal.classList.remove("show")}updateContent(){var e;const t=null==(e=this.modal)?void 0:e.querySelector(".settings-modal-body");if(!t)return;const o=Array.from(n.getCategories());t.innerHTML="",0===o.length?t.innerHTML='<p style="text-align: center; color: #666; padding: 20px;">暂无类别数据</p>':o.forEach(e=>{const o=this.getIconForCategory(e),i=document.createElement("div");i.className="category-setting";const s=document.createElement("div");s.className="category-setting-header";const a=document.createElement("div");a.className="category-name",a.textContent=e;const c=document.createElement("div");c.className="category-controls";const d=document.createElement("label");d.className="show-text-label";const r=document.createElement("input");r.type="checkbox",r.className="show-text-checkbox",r.dataset.category=e,r.checked=o.showText,d.appendChild(r),d.appendChild(document.createTextNode("显示文本"));const l=document.createElement("label");l.className="text-size-label";const p=document.createElement("input");p.type="number",p.className="text-size-input",p.dataset.category=e,p.value=o.textSize.toString(),p.min="8",p.max="24",l.appendChild(document.createTextNode("文本大小")),l.appendChild(p);const g=document.createElement("label");g.className="icon-size-label";const h=document.createElement("input");h.type="number",h.className="icon-size-input",h.dataset.category=e,h.value=o.iconSize.toString(),h.min="12",h.max="128",g.appendChild(document.createTextNode("图标大小")),g.appendChild(h),l.style.display=o.showText?"flex":"none",r.addEventListener("change",()=>{l.style.display=r.checked?"flex":"none"}),c.appendChild(d),c.appendChild(l),c.appendChild(g),s.appendChild(a),s.appendChild(c);const m=document.createElement("div");m.className="icon-selector",n.icons.forEach(n=>{const t=document.createElement("div");t.className="icon-option",t.style.backgroundImage=`url('${n.path}')`,t.dataset.iconName=n.name,t.dataset.category=e,o.icon===n.path&&t.classList.add("selected"),t.addEventListener("click",()=>{m.querySelectorAll(".icon-option").forEach(n=>n.classList.remove("selected")),t.classList.add("selected")}),m.appendChild(t)}),i.appendChild(s),i.appendChild(m),t.appendChild(i)})}saveSettings(){var t;const o=null==(t=this.modal)?void 0:t.querySelector(".settings-modal-body");if(!o)return;const i={};o.querySelectorAll(".category-setting").forEach(e=>{var t,o;const s=null==(t=e.querySelector(".category-name"))?void 0:t.textContent;if(s){const t=e.querySelector(".icon-option.selected"),a=null==t?void 0:t.dataset.iconName,c=null==(o=n.icons.find(n=>n.name===a))?void 0:o.path,d=e.querySelector(".show-text-checkbox"),r=e.querySelector(".text-size-input"),l=e.querySelector(".icon-size-input");c&&(i[s]={catetory:s,icon:c,showText:d.checked,textSize:parseInt(r.value,10)||12,iconSize:parseInt(l.value,10)||32})}}),this.config=i,n.setSettings(i),this.hide(),e.show("设置已保存","success"),this.onConfigChanged&&this.onConfigChanged(i)}initIconSettings(){const e=n.getConfig();if(e){const t=e;Object.keys(t).forEach(e=>{const o=t[e];if(!o.icon){const e=n.icons.find(n=>"default"===n.name)||n.icons[0];o.icon=e.path}"number"!=typeof o.textSize&&(o.textSize=12),"number"!=typeof o.iconSize&&(o.iconSize=32)}),this.config=t}else{n.getAllCategories().forEach((e,t)=>{this.config[e]||(this.config[e]={catetory:e,icon:n.icons[t%n.icons.length].path,showText:!0,textSize:12,iconSize:32})})}}getIconForCategory(e){if(!this.config[e]){const t=Array.from(n.getAllCategories()).indexOf(e),o=n.icons[t%n.icons.length]||n.icons[0];this.config[e]={catetory:e,icon:o.path,showText:!0,textSize:12,iconSize:32}}return this.config[e]}};t.instance=null;let o=t;export{o as IconConfigDialog};
