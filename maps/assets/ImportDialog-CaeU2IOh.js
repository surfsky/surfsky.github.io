import{T as n,d as t}from"./map-B5t8AdmZ.js";const e=class e{constructor(){this.modal=null,this.dropZone=null,this.fileInput=null,this.createModal(),this.bindEvents(),this.injectStyles()}static getInstance(){return this.instance||(this.instance=new e),this.instance}static show(n,t){const e=this.getInstance();e.onImportStart=n,e.onImportOk=t,e.show()}static hide(){this.getInstance().hide()}createModal(){this.modal=document.createElement("div"),this.modal.className="import-modal",this.modal.innerHTML='\n            <div class="import-modal-content">\n                <div class="import-modal-header">\n                    <h3>ÂØºÂÖ•Êï∞ÊçÆ</h3>\n                    <button class="import-close-btn" data-action="close">√ó</button>\n                </div>\n                <div class="import-drop-zone" id="import-drop-zone">\n                    <div class="import-drop-content">\n                        <div class="import-icon">üìÅ</div>\n                        <p class="import-title">ÊãñÊãΩExcelÊñá‰ª∂Âà∞Ê≠§Â§ÑÊàñÁÇπÂáªÈÄâÊã©Êñá‰ª∂</p>\n                        <p class="import-format">ÊîØÊåÅ .xlsx Âíå .xls Ê†ºÂºè„ÄÇ</p>\n                    </div>\n                </div>\n                <input type="file" id="import-file-input" accept=".xlsx,.xls" style="display: none;">\n                <div class="import-buttons">\n                    <a href=\'../data/demo.xlsx\'>Á§∫‰æã‰∏ãËΩΩ</a>\n                    <button class="import-btn secondary" data-action="close">ÂèñÊ∂à</button>\n                </div>\n            </div>\n        ',document.body.appendChild(this.modal),this.dropZone=this.modal.querySelector("#import-drop-zone"),this.fileInput=this.modal.querySelector("#import-file-input")}bindEvents(){this.modal&&this.dropZone&&this.fileInput&&(this.modal.addEventListener("click",n=>{"close"===n.target.getAttribute("data-action")&&this.hide()}),this.modal.addEventListener("click",n=>{n.target===this.modal&&this.hide()}),this.dropZone.addEventListener("dragover",n=>{var t;n.preventDefault(),null==(t=this.dropZone)||t.classList.add("dragover")}),this.dropZone.addEventListener("dragleave",n=>{var t;n.preventDefault(),null==(t=this.dropZone)||t.classList.remove("dragover")}),this.dropZone.addEventListener("drop",n=>{var t,e;n.preventDefault(),null==(t=this.dropZone)||t.classList.remove("dragover");const o=null==(e=n.dataTransfer)?void 0:e.files;o&&o.length>0&&this.handleFile(o[0])}),this.dropZone.addEventListener("click",n=>{this.fileInput&&this.fileInput.click()}),this.fileInput.addEventListener("change",n=>{const t=n.target,e=t.files;e&&e.length>0&&(this.handleFile(e[0]),t.value="")}),document.addEventListener("keydown",n=>{var t;"Escape"===n.key&&(null==(t=this.modal)?void 0:t.classList.contains("show"))&&this.hide()}))}async handleFile(e){if(e.name.endsWith(".xlsx")||e.name.endsWith(".xls"))try{this.onImportStart&&this.onImportStart(),await t.LoadFromFile(e),this.onImportOk&&this.onImportOk(),this.hide()}catch(o){n.error(`Êñá‰ª∂Ëß£ÊûêÂ§±Ë¥•: ${o instanceof Error?o.message:String(o)}`)}else n.error("ËØ∑ÈÄâÊã©ExcelÊñá‰ª∂Ôºà.xlsxÊàñ.xlsÊ†ºÂºèÔºâ")}show(){this.modal&&this.modal.classList.add("show")}hide(){this.modal&&this.modal.classList.remove("show")}injectStyles(){const n="import-modal-styles";if(document.getElementById(n))return;const t=document.createElement("style");t.id=n,t.textContent="\n            .import-modal {\n                position: fixed;\n                top: 0;\n                left: 0;\n                width: 100%;\n                height: 100%;\n                background: rgba(0, 0, 0, 0.5);\n                display: flex;\n                justify-content: center;\n                align-items: center;\n                z-index: 20000;\n                opacity: 0;\n                visibility: hidden;\n                transition: all 0.3s ease;\n            }\n\n            .import-modal.show {\n                opacity: 1;\n                visibility: visible;\n            }\n\n            .import-modal-content {\n                background: white;\n                border-radius: 12px;\n                padding: 0;\n                width: 90%;\n                max-width: 480px;\n                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);\n                transform: scale(0.9);\n                transition: transform 0.3s ease;\n                overflow: hidden;\n            }\n\n            .import-modal.show .import-modal-content {\n                transform: scale(1);\n            }\n\n            .import-modal-header {\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n                padding: 20px 24px;\n                border-bottom: 1px solid #e9ecef;\n                background: #f8f9fa;\n            }\n\n            .import-modal-header h3 {\n                margin: 0;\n                font-size: 18px;\n                font-weight: 600;\n                color: #333;\n            }\n\n            .import-close-btn {\n                background: none;\n                border: none;\n                font-size: 24px;\n                color: #6c757d;\n                cursor: pointer;\n                padding: 0;\n                width: 32px;\n                height: 32px;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                border-radius: 50%;\n                transition: all 0.2s ease;\n            }\n\n            .import-close-btn:hover {\n                background: #e9ecef;\n                color: #495057;\n            }\n\n            .import-drop-zone {\n                margin: 24px;\n                border: 2px dashed #dee2e6;\n                border-radius: 8px;\n                padding: 40px 20px;\n                text-align: center;\n                cursor: pointer;\n                transition: all 0.3s ease;\n                background: #fafbfc;\n                position: relative;\n            }\n\n            .import-drop-zone:hover {\n                border-color: #007bff;\n                background: #f0f8ff;\n            }\n\n            .import-drop-zone.dragover {\n                border-color: #007bff;\n                background: #e3f2fd;\n                transform: scale(1.02);\n            }\n\n            .import-drop-content {\n                pointer-events: none;\n            }\n\n            .import-icon {\n                font-size: 48px;\n                margin-bottom: 16px;\n                opacity: 0.7;\n            }\n\n            .import-title {\n                font-size: 16px;\n                font-weight: 600;\n                color: #333;\n                margin: 0 0 8px 0;\n            }\n\n            .import-subtitle {\n                font-size: 14px;\n                color: #6c757d;\n                margin: 0 0 12px 0;\n            }\n\n            .import-format {\n                font-size: 12px;\n                color: #adb5bd;\n                margin: 0;\n            }\n\n            .import-buttons {\n                padding: 16px 24px;\n                border-top: 1px solid #e9ecef;\n                display: flex;\n                justify-content: flex-end;\n                gap: 12px;\n                background: #f8f9fa;\n            }\n\n            .import-btn {\n                padding: 8px 20px;\n                border: none;\n                border-radius: 6px;\n                font-size: 14px;\n                font-weight: 500;\n                cursor: pointer;\n                transition: all 0.2s ease;\n            }\n\n            .import-btn.secondary {\n                background: #6c757d;\n                color: white;\n            }\n\n            .import-btn.secondary:hover {\n                background: #545b62;\n            }\n\n            .import-btn:active {\n                transform: translateY(1px);\n            }\n        ",document.head.appendChild(t)}};e.instance=null;let o=e;export{o as ImportDialog};
