class e{static async readExcel(e){const t=await fetch(e),r=await t.arrayBuffer(),a=XLSX.read(r,{type:"array"}),n=a.Sheets[a.SheetNames[0]];return XLSX.utils.sheet_to_json(n)}static async readExcelFile(e,t){return new Promise((r,a)=>{const n=new FileReader;n.onload=e=>{var n;try{const a=new Uint8Array(null==(n=e.target)?void 0:n.result),o=XLSX.read(a,{type:"array"}),s=t||o.SheetNames[0],c=o.Sheets[s],l=XLSX.utils.sheet_to_json(c);r(l)}catch(o){a(o)}},n.onerror=()=>a(new Error("文件读取失败")),n.readAsArrayBuffer(e)})}static async getSheetNames(e){return new Promise((t,r)=>{const a=new FileReader;a.onload=e=>{var a;try{const r=new Uint8Array(null==(a=e.target)?void 0:a.result),n=XLSX.read(r,{type:"array"});t(n.SheetNames)}catch(n){r(n)}},a.onerror=()=>r(new Error("文件读取失败")),a.readAsArrayBuffer(e)})}static exportExcel(e,t="export.xlsx",r=!1){const a=XLSX.utils.json_to_sheet(e);if(r){const e=XLSX.utils.decode_range(a["!ref"]),t=XLSX.utils.encode_col(e.e.c);a["!autofilter"]={ref:`A1:${t}1`},a["!freeze"]={ySplit:1}}const n=XLSX.utils.book_new();XLSX.utils.book_append_sheet(n,a,"Sheet1"),XLSX.writeFile(n,t)}}class t{static downFile(e,t){const r=URL.createObjectURL(e),a=document.createElement("a");a.href=r,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r)}static sendEvent(e,t){const r=new CustomEvent(e,{detail:t});document.dispatchEvent(r)}static getExportFileName(e){var t=new Date;return`${`${t.getFullYear().toString().slice(2)}${(t.getMonth()+1).toString().padStart(2,"0")}${t.getDate().toString().padStart(2,"0")}`}-${e}`}static escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}}export{e as E,t as W};
