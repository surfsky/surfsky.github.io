!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&r(e)}).observe(document,{childList:!0,subtree:!0})}function r(e){if(e.ep)return;e.ep=!0;const r=function(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?r.credentials="include":"anonymous"===e.crossOrigin?r.credentials="omit":r.credentials="same-origin",r}(e);fetch(e.href,r)}}();class e{static async readExcel(e){const r=await fetch(e),t=await r.arrayBuffer(),o=XLSX.read(t,{type:"array"}),s=o.Sheets[o.SheetNames[0]];return XLSX.utils.sheet_to_json(s)}static async readExcelFile(e,r){return new Promise((t,o)=>{const s=new FileReader;s.onload=e=>{var s;try{const o=new Uint8Array(null==(s=e.target)?void 0:s.result),n=XLSX.read(o,{type:"array"}),a=r||n.SheetNames[0],i=n.Sheets[a],c=XLSX.utils.sheet_to_json(i);t(c)}catch(n){o(n)}},s.onerror=()=>o(new Error("文件读取失败")),s.readAsArrayBuffer(e)})}static async getSheetNames(e){return new Promise((r,t)=>{const o=new FileReader;o.onload=e=>{var o;try{const t=new Uint8Array(null==(o=e.target)?void 0:o.result),s=XLSX.read(t,{type:"array"});r(s.SheetNames)}catch(s){t(s)}},o.onerror=()=>t(new Error("文件读取失败")),o.readAsArrayBuffer(e)})}static exportExcel(e,r="export.xlsx",t=!1){const o=XLSX.utils.json_to_sheet(e);t&&(o["!freeze"]={ySplit:1});const s=XLSX.utils.book_new();XLSX.utils.book_append_sheet(s,o,"Sheet1"),XLSX.writeFile(s,r)}}export{e as E};
