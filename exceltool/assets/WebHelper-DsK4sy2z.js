!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();class e{static async readExcel(e){const t=await fetch(e),r=await t.arrayBuffer(),o=XLSX.read(r,{type:"array"}),n=o.Sheets[o.SheetNames[0]];return XLSX.utils.sheet_to_json(n)}static async readExcelFile(e,t){return new Promise((r,o)=>{const n=new FileReader;n.onload=e=>{var n;try{const o=new Uint8Array(null==(n=e.target)?void 0:n.result),a=XLSX.read(o,{type:"array"}),s=t||a.SheetNames[0],c=a.Sheets[s],i=XLSX.utils.sheet_to_json(c);r(i)}catch(a){o(a)}},n.onerror=()=>o(new Error("文件读取失败")),n.readAsArrayBuffer(e)})}static async getSheetNames(e){return new Promise((t,r)=>{const o=new FileReader;o.onload=e=>{var o;try{const r=new Uint8Array(null==(o=e.target)?void 0:o.result),n=XLSX.read(r,{type:"array"});t(n.SheetNames)}catch(n){r(n)}},o.onerror=()=>r(new Error("文件读取失败")),o.readAsArrayBuffer(e)})}static exportExcel(e,t="export.xlsx",r=!1){const o=XLSX.utils.json_to_sheet(e);r&&(o["!freeze"]={ySplit:1});const n=XLSX.utils.book_new();XLSX.utils.book_append_sheet(n,o,"Sheet1"),XLSX.writeFile(n,t)}}class t{static downFile(e,t){const r=URL.createObjectURL(e),o=document.createElement("a");o.href=r,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(r)}static sendEvent(e,t){const r=new CustomEvent(e,{detail:t});document.dispatchEvent(r)}static getExportFileName(e){var t=new Date;return`${`${t.getFullYear().toString().slice(2)}${(t.getMonth()+1).toString().padStart(2,"0")}${t.getDate().toString().padStart(2,"0")}`}-${e}`}static escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}}export{e as E,t as W};
